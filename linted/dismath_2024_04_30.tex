\documentclass[12pt]{article}
\usepackage{preamble}

\pagestyle{fancy}
\fancyhead[LO,LE]{$\mathcal{D}$искретная математика}
\fancyhead[CO,CE]{30.04.2024}
\fancyhead[RO,RE]{Лекции Чухарева К. И.}



\begin{document}
    \Ex мультиномиальной теоремы:

    $\displaystyle (x + y + z)^4 = 1 (x^4 + y^4 + z^4) + 4 (xy^3 + xz^3 + x^3y + yz^3 + y^3z + yz^3) +
    6(x^2y^2 + y^2z^2 + x^2z^2) + 12 (xyz^2 + xy^2z + x^2yz)$

    Доказательство:

    $\Box$

    $\displaystyle (x_1 + \dots + x_r)^n = \sum_{\substack{i_j \in [r] \\ j \in [n]}} x_{i_1}^1 \cdot \dots \cdot x_{i_n}^1 =
    \sum_{\substack{i_j \in [r] \\ j \in [n]}} x_1^{k_1} \cdot \dots \cdot x_r^{k_r}$, где $\displaystyle k_t$ - количество $x$ с индексом $t$ в одночлене ($\displaystyle k_t = |\Set{j \in [n] | i_j = t}|$)

    Получается мультиномиальный коэффицциент $\displaystyle \begin{pmatrix}
                                                  n \\ k_1, \dots, k_r
    \end{pmatrix}$
    будет равен количество способов поставить $\displaystyle k_1$ единиц в индексы в $\displaystyle x_{i_1}^1 \cdot \dots \cdot x_{i_n}^1$, $\displaystyle k_2$ двоек в индексы и так далее

    У нас есть $\displaystyle \begin{pmatrix}
                    n \\ k_1
    \end{pmatrix}$ способов поставить единицу в индексы в одночлен,
    $\displaystyle \begin{pmatrix}
         n - k_1 \\ k_2
    \end{pmatrix}$ способов поставить двойку и т. д., получаем:

    $\displaystyle \begin{pmatrix}
         n \\ k_1, \dots, k_r
    \end{pmatrix} = \begin{pmatrix}
                        n \\ k_1
    \end{pmatrix} \begin{pmatrix}
                      n - k_1 \\ k_2
    \end{pmatrix} \dots \begin{pmatrix}
                            n - k_1 - \dots - k_{r - 1} \\ k_r
    \end{pmatrix} = [n - k_1 - \dots - k_r = 0] = \\
    \frac{n!}{k_1! (n - k_1)!} \frac{(n - k_1)!}{k_2! (n - k_1 - k_2)!} \dots \frac{(n - k_1 - \dots - k_{r - 1})!}{k_r! 0!} = \frac{n!}{k_1! \dots k_r!}$

    $\Box$

    \begin{itemize}

        \item \textbf{Перестановка мультимножества $\displaystyle \Sigma^*$} (Permutations of a multiset $\displaystyle \Sigma^*$)

        $\displaystyle \Sigma^* = \Set{\triangle^1, \triangle^2, \Box, \star} = (\Sigma, r) \quad r : \Sigma \to \Natural_0 \quad n = |\Sigma^*| = 4 \quad s = |\Sigma| = 3$

        \Nota \begin{cases}
                  \triangle^1, \triangle^2, \Box, \star \\
                  \triangle^2, \triangle^1, \Box, \star
        \end{cases} считаются равными перестановками

        $\displaystyle |P^*(\Sigma^*, n)| = \frac{n!}{r_1! \dots r_s!} = \begin{pmatrix}
                                                               n \\ r_1, \dots, r_s
        \end{pmatrix}$ - количество перестановок мультимножества, где $\displaystyle r_i$ - количество $i$-ого элемента в мультимножестве

        \item \textbf{$k$-комбинация бесконечного мультимножества} ($k$-combinations of infinite multiset) -
        такое субмультимножество размера $k$, содержащее элементы из исходного мультимножества.
        При этом соблюдается, что количество какого-либо элемента $\displaystyle r_i$ в исходном мультимножестве не больше размера комбинации $k$

        $\displaystyle \Sigma^* = \Set{\infty \cdot \triangle, \infty \cdot \Box, \infty \cdot \star, \infty \cdot \Cat}^* \quad n = |\Sigma^*| = \infty$

        $\Sigma = \Set{\triangle, \Box, \star, \Cat} \quad s = |\Sigma| = 4$

        \Ex $5$-комбинация: $\Set{\triangle, \star, \Box, \star, \Box}$

        Разделяем на группы по $\Sigma$ палочками:

        $\triangle \Big| \Box \Box \Big| \star \star \Big| $

        Заменяем элементы на точечки - нам уже не так важен тип элемента, потому что мы знаем из разделения:

        $\bullet \Big| \bullet \bullet \Big| \bullet \bullet \Big| $

        (другой \Exs $\bullet \bullet \bullet \bullet \Big| \Big| \Big| \bullet = \Set{4 \cdot \triangle, 1 \cdot \Cat}$)

        Получается всего $k$ точечек и $s - 1$ палочек, всего $k + s - 1$ объектов. Получаем мультимножество $\Set{k \cdot \bullet, (s - 1) \cdot \Big|}$ (\textit{Star and Bars method})

        Получаем количество перестановок этого мультимножества:
        $\displaystyle \frac{(k + s - 1)!}{k!(s - 1)!} = \begin{pmatrix}
                                               k + s - 1 \\ k, s - 1
        \end{pmatrix} =
        \begin{pmatrix}
            k + s - 1 \\ k
        \end{pmatrix} = \begin{pmatrix}
                            k + s - 1 \\ s - 1
        \end{pmatrix}$

        что и является количеством возможных $k$-комбинаций бесконечного мультимножества

        \vspace{5mm}

        \item \textbf{Слабая композиция} (Weak composition) неотрицательного целого числа $n$ в $k$ частей -
        это решение $\displaystyle (b_1, \dots, b_k)$ уравнение $\displaystyle b_1 + \dots + b_k = n$, где $\displaystyle b_i \geq 0$

        $|\Set{\text{слабая композиция } n \text{ в } k \text{ частей}}| = \begin{pmatrix}
                                                                               n + k - 1 \\ n, k - 1
        \end{pmatrix}$

        Для решения воспользуемся аналогичным из доказательства мультиномиальной теоремы приемом:

        $n = 1 + 1 + 1 + \dots + 1$

        Поставим палочки:

        $n = 1 + 1 \Big| 1 \Big| \dots + 1$

        Получаем задачу поиска количеств $k$-комбинаций в мультимножестве: $\Set{n \cdot 1, (k - 1) \cdot \Big|}$; получаем $\begin{pmatrix}
                                                                                                                                 n + k - 1 \\ n, k - 1
        \end{pmatrix}$

        \vspace{5mm}
        \item \textbf{Композиция} (Composition) - решение для $\displaystyle b_1 + \dots + b_k = n$, где $\displaystyle b_i > 0$

        $|\Set{\text{композиция } n \text{ в } k \text{ частей}}| = \begin{pmatrix}
                                                                        n - k + k - 1 \\ n - k, k - 1
        \end{pmatrix}$

        Мы знаем, что одну единичку получит каждая $\displaystyle b_i$, поэтому мы решаем это как слабую композицию для $n - k$ в $k$ частей

        \vspace{5mm}
        \item \textbf{Число композиций $n$ в некоторой число частей} (Number of all compositions into some number of positive parts)

        $\displaystyle \sum_{k=1}^n \begin{pmatrix}
                          n - 1 \\ k - 1
        \end{pmatrix} = 2^{n-1}$

        Пусть $t = k - 1$, тогда $\displaystyle \sum_{t = 0}^{n-1} \begin{pmatrix}
                                                         n - 1 \\ t
        \end{pmatrix} = 2^{n - 1}$

        \vspace{5mm}
        \item \textbf{Разбиения множества} (Set partitions) - множество размера $k$ непересекающихся непустых подмножеств

        \begin{tabular}{cp}
            \Exs $\Set{1, 2, 3, 4}, n = 4, k = 2 \rightarrow [\text{разбиение в 2 части}] \rightarrow & \Set{\Set{1}, \Set{2, 3, 4}}, \\
            & \Set{\Set{1, 2}, \Set{3, 4}}, \\
            & \Set{\Set{1, 2, 3}, \Set{4}}, \\
            & \Set{\Set{1, 3}, \Set{2, 4}}, \\
            & \Set{\Set{1, 4}, \Set{2, 3}}, \\
            & \Set{\Set{2}, \Set{1, 3, 4}}, \\
            & \Set{\Set{3}, \Set{1, 2, 4}}$
        \end{tabular}

        $\displaystyle |\Set{\text{разбиение } n \text{ элементов в } k \text{ частей}}| = \begin{Bmatrix}
                                                                                 n \\ k
        \end{Bmatrix} = S^{II}_k (n) = S(n, k)$ - число Стирлинга второго рода

        Для примера выше число Стирлинга $S(4, 2) = \begin{Bmatrix}
                                                        4 \\ 2
        \end{Bmatrix} = 7$

        Согласно Википедии \href{https://ru.wikipedia.org/wiki/%D0%A7%D0%B8%D1%81%D0%BB%D0%B0_%D0%A1%D1%82%D0%B8%D1%80%D0%BB%D0%B8%D0%BD%D0%B3%D0%B0_%D0%B2%D1%82%D0%BE%D1%80%D0%BE%D0%B3%D0%BE_%D1%80%D0%BE%D0%B4%D0%B0}{для формулы Стирлинга}
        есть формула: $\displaystyle S(n, k) = \frac{1}{k!} \sum_{j=0}^k (-1)^{k+j} \begin{pmatrix}
                                                                          k \\ j
        \end{pmatrix}j^n$

        \vspace{5mm}
        \item \textbf{Формула Паскаля} (Pascal's formula)

        $\begin{pmatrix}
             n \\ k
        \end{pmatrix} = \begin{pmatrix}
                            n - 1 \\ k - 1
        \end{pmatrix} + \begin{pmatrix}
                            n - 1 \\ k
        \end{pmatrix}$

        \vspace{5mm}
        \item \textbf{Рекуррентное отношение для чисел Стирлинга} (Recurrence relation for Stirling$\displaystyle ^{(2)}$ number):

        $\begin{Bmatrix}
             n \\ k
        \end{Bmatrix} = \begin{Bmatrix}
                            n - 1 \\ k - 1
        \end{Bmatrix} + k \cdot \begin{Bmatrix}
                                    n - 1 \\ k
        \end{Bmatrix}$

        Возьмем какое-либо разбиение для $n - 1$ элементов на $k$ частей, тогда возможны два случая:

        1) В $k$-ое множество нет ни одного элемента, тогда мы обязаны в него положить наш $n$-ый элемент по определению,
        количество перестановок будет равно $\begin{Bmatrix}
                                                 n - 1 \\ k - 1
        \end{Bmatrix} \cdot 1$

        2) В $k$-ом множестве уже есть элементы, тогда все множества будут заполнены и у нас будет выбор из $k$ множеств,
        куда положить $k$-ый элемент, то есть $k \cdot \begin{Bmatrix}
                                                           n - 1 \\ k
        \end{Bmatrix}$

        Эти два случая независимы, поэтому получаем $\begin{Bmatrix}
                                                         n - 1 \\ k - 1
        \end{Bmatrix} + k \cdot \begin{Bmatrix}
                                    n - 1 \\ k
        \end{Bmatrix}$

        \vspace{5mm}
        \item \textbf{Число Белла} (Bell number) - количество всех неупорядоченных разбиений множества размера $n$

        Число Белла вычисляется по формуле: $\displaystyle B_n = \sum_{m=0}^n S(n, m)$

        \vspace{5mm}
        \item \textbf{Целочисленное разбиение} (Integer partition) - решение для $\displaystyle a_1 + \dots + a_k = n$, где $\displaystyle a_1 \geq a_2 \geq \dots \geq a_k \geq 1$

        $p(n, k)$ - число целочисленных разбиений $n$ в $k$ частей

        $\displaystyle p(n) = \sum_{k = 1}^n p(n, k)$ - число всех разбиений для $n$

        \Ex $5 = 5 = 4 + 1 = 3 + 2 = 3 + 1 + 1 = 2 + 2 + 1 = 2 + 1 + 1 + 1 = 1 + 1 + 1 + 1 + 1$

        \vspace{5mm}

    \end{itemize}


\end{document}
