## Лекция 5. Продвинутый CSS

### Каскадность и приоритет селекторов

В CSS свойства для одного элемента могут накладываться друг на друга. Допустим, что есть такой элемент:

```html
<p class="bold dark">
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
</p>
```

с такими стилями:

```css
p {
    font-size: 20px;
}

.bold {
    font-weight: bold;
}

.dark {
    color: #666666;
}
```

<style>
p.example-rule-cascade {
    font-size: 20px;
}

.bold.example-rule-cascade {
    font-weight: bold;
}

.dark.example-rule-cascade {
    color: #666666;
}
</style>

> <p class="example-rule-cascade dark bold"> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>

Элемент имеет два класса, CSS-правила к нему применяются, поэтому в итоге свойства для элемента будут такими:

```css
{
    color: #666666;
    font-weight: bold;
    font-size: 20px;
}
```

Это и называется каскадностью правил. При этом у правил действует приоритет селекторов. Рассмотрим такой пример:

```css
p {
    color: green;
}

#blue {
    color: blue;
}

.red {
    color: red;
}
```

Цвет текста такого элемента:

```html
<p class="red" id="blue">Бургер</p>
```

будет синим:

<style>
p.example-selector-priority {
    color: green;
}

#blue.example-selector-priority {
    color: blue;
}

.red.example-selector-priority {
    color: red;
}
</style>

> <p class="example-selector-priority red" id="blue">Бургер</p>

Связано это с тем, что правила имеют следующий приоритет:

* Встроенные стили в самом теге, например, `<p style="color: red;">`
* Селектор с идентификатором
* Селектор с классом, атрибутом, псевдоклассом
* Селектор с тегом или псевдоэлементом
* Универсальный селектор `*`

---

Если элемент имеет несколько классов, свойства для которых противоречат друг другу, то применяться будут те свойства, что стоят последними - браузер просто перезапишет правила, которые стояли перед ним:

```css
.my-text {
    color: blue;
}

.your-text {
    color: red;
}
```

```html
<p class="your-text my-text">Яблоко лежало на поляне</p>
```

<style>
.my-text.example-rule-overwrite {
    color: blue;
}

.your-text.example-rule-overwrite {
    color: red;
}
</style>

> <p class="example-rule-overwrite your-text my-text">Яблоко лежало на поляне</p>

---

Если два правила, то приоритет вычисляет немного сложнее. Для этого составляется кортежи из 4 чисел:

* Число встроенных стилей в тег
* Число идентификаторов в селекторе
* Число классов, атрибутов и псевдоклассов в селекторе
* Число тегов и псевдоэлементов в селекторе

Затем эти кортежи сравниваются. Так селектор `p.my-text.bold-text#this-id` `(0, 1, 2, 1)` имеет больший приоритет, чем `p.your-text#that-id` `(0, 1, 1, 1)`

---

Помимо этого существует еще один список приоритетов:

* Правила пользовательского агента (User Agent), то есть браузера. Это включает стили по умолчанию, которые поставляются с браузером, например, синий цвет у ссылок
* Правила пользователя (User Normal), такие как размер шрифта, выставленный в настройках браузер
* Правила автора (Author Normal), то есть разработчика стилей, которые загружаются вместе с веб-страницей
* Важные правила автора (Author `!important`)
* Важные правила пользователя (User `!important`)

Важные правила в коде обозначаются с помощью `!important`:

```css
p {
    color: red !important;
}
```

Такие правила имеют больший приоритет, а наибольший имеют пользовательские важные правила, чтобы обеспечивать доступность для пользователей с ограничениями

### Методологии CSS

Часто CSS-код разрастается до таких масштабов, что его становится трудно поддерживать. По этой причине начали создаваться методологии - практики организации кода для его лучшей читаемости и изменения

#### БЭМ

Методология БЭМ (Блок-Элемент-Модификатор) была создана в Яндексе. Основная ее концепция заключается в том, чтобы легко поддерживать проекты и повторно использовать компоненты

Для этого в БЭМ есть три понятия:

* Блок - функционально независимый компонент страницы, который может быть повторно использован

    Блоки можно использовать в любом месте на странице, поэтому в CSS-коде для блоков не должно быть никаких внешних отступов и правил позиционирования. При выборе имени нужно убедиться, что оно описывает назначение блока, а не его внешний вид или состояние

* Элемент - составная часть блока, которая не может использоваться в отрыве от него

    То есть элементы живут только в блоках, не могут принадлежать другим элементам. Также имена элементов описывают их назначение, а не внешний вид

* Модификатор - сущность, определяющая внешний вид, состояние или поведение блока либо элемента

    Примером модификатора может быть фиксация в верхней части страницы для шапки

Плюсы БЭМ:

* Новые разработчики могут быстро понять связь между компонентами в разметке и CSS
* Методология способствует повышению производительности в команде. Преимущества особенно заметны в крупных проектах
* Система именования снижает риски коллизий с классами и утечку стилей
* CSS несильно привязан к разметке в определенном месте на странице
* CSS становится повторно используемым

Подробнее ознакомиться можно на сайте <https://bem.info/>

#### SMACSS

Методология SMACSS (Scalable and Modular Architecture for CSS) создана Джонатаном Снуком и основана на разделении правил на категории:

* Base - базовые правила, определяющие внешний вид элементов по умолчанию
* Layout - правила, с помощью которых страница разделяется на секции
* Module - правила, которые применяются к повторно используемым модулям
* State - правила для макета или модулей, которые применяются в определенном состоянии
* Theme - правила, отвечающие за внешний вид макетов и модулей при определенно заданном стиле

Для классов правил Layout добавляется префикс `l-`, `grid-` или `layout-`, а для правил State префиксы состояния `is-` или `has-`

Для модулей используются имена компонентов. Связанные элементы внутри модуля и вариации модуля должны использовать базовое имя модуля в качестве префикса

В отличие от БЭМ, SMACSS не предписывает слишком строгое соглашение об именовании

Преимущества SMACSS:

* Подход предлагает правильные рекомендации для модульного и поддерживаемого CSS-кода, избегая при этом излишних предписаний
* Система именования SMACSS менее подробна и проще БЭМ
* Система достаточно гибкая, чтобы работать с крупными и маленькими проектами

Подробнее о SMACSS: <https://smacss.com/>

#### eCSS

Методология eCSS (Enduring CSS) была создана Беном Фрейном и состоит в изоляции компонентов, чтобы повторно их использовать

Это достигается за счет инкапсуляции всего кода (не только CSS), необходимых для постройки всех компонентов, в своих общих папках и создания совершенно нового компонента каждый раз, когда нужен компонент, похожий на уже существующий, но в котором будут некоторые незначительные изменения

eCSS отходит от таких методологий, как БЭМ и SMACSS, которые расширяют и абстрагируются от существующих компонентов, тем самым избегая или пытаясь как можно сильнее избежать повторения кода

Бен Фрейн пришел к выводу, что современные алгоритмы сжатия хорошо сжимают повторяющийся CSS-код, поэтому разница в весе файлов незначительна

Преимущества eCSS:

* Изоляция всех визуальных шаблонов облегчает обслуживание CSS-кода
* Несмотря на повторяющиеся свойства и значения, размер файла в долгосрочной перспективе почти не увеличится. Это происходит потому, что модули являются автономными, и их можно быстро удалить без страха поломать дизайн, если они больше не нужны
* Все языковые и технические файлы, необходимые для создания модуля, расположены в одной папке
